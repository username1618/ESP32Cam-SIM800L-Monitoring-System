# ESP32-CAM + SIM800L: –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ üì°üì∏

## ESP32-CAM + SIM800L

–ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è IoT-–∫–∞–º–µ—Ä–∞ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ–º –∏ –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ GPRS/HTTP/FTP

## üåü –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ –±–∞–∑–µ ESP32-CAM —Å GSM-–º–æ–¥—É–ª–µ–º SIM800L, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –≤ —É—Å–ª–æ–≤–∏—è—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è Wi-Fi —Å–µ—Ç–∏. –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –ø—Ä–æ–¥—É–º–∞–Ω–Ω–æ–º—É —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—é –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –º–æ–±–∏–ª—å–Ω—É—é —Å–µ—Ç—å.

## üîë –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üì∑ –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—ä–µ–º–∫–∞
- –ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞–º–µ—Ä—ã (—ç–∫—Å–ø–æ–∑–∏—Ü–∏—è, –±–∞–ª–∞–Ω—Å –±–µ–ª–æ–≥–æ, —Ñ–∏–ª—å—Ç—Ä—ã)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–æ 1600x1200 —Å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ —Ñ–∏–∫—Å–∞–º–∏ –¥–ª—è AI-Thinker
- –ó–∞—Ö–≤–∞—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –∏–ª–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

### ‚ö° –£–ª—å—Ç—Ä–∞-–Ω–∏–∑–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ
- –ì–∏–±—Ä–∏–¥–Ω—ã–π —Ä–µ–∂–∏–º —Å–Ω–∞ (–≥–ª—É–±–æ–∫–∏–π/–ª–µ–≥–∫–∏–π —Å–æ–Ω)
- –î–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–µ—Ç —Ä–∞–±–æ—Ç—ã –æ—Ç –±–∞—Ç–∞—Ä–µ–∏ 18650 –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è!
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–∞–π–º–µ—Ä—É / PIR-–¥–∞—Ç—á–∏–∫—É

### üì° –ù–∞–¥–µ–∂–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö
- –î–≤–æ–π–Ω–æ–π —Ä–µ–∂–∏–º –æ—Ç–ø—Ä–∞–≤–∫–∏: HTTP –∏/–∏–ª–∏ FTP
- –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ —Å–±–æ—è—Ö (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫)
- –°–ú–°-–æ–ø–æ–≤–µ—â–µ–Ω–∏—è –∏ –≥–æ–ª–æ—Å–æ–≤—ã–µ –≤—ã–∑–æ–≤—ã –ø—Ä–∏ —Ç—Ä–µ–≤–æ–≥–µ

### üñ• –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–∞–º–µ—Ä—ã –∏ –¥–∞—Ç—á–∏–∫–æ–≤
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π –∏ –°–ú–°

### üß† –°–∞–º–æ–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä APN –¥–ª—è –ª—é–±–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Å–≤—è–∑–∏

## üõ† –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- ESP32-CAM (OV2640, AI_THINKER) - [—Å—Å—ã–ª–∫–∞]()
- SIM800L - [—Å—Å—ã–ª–∫–∞]()
- TTL UART –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä USB CP2102 - [—Å—Å—ã–ª–∫–∞]()
- –ü–æ–Ω–∏–∂–∞—é—â–∏–π –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å GSMIN MP1584EN DC-DC - [—Å—Å—ã–ª–∫–∞]()
- –ò–Ω—Ñ—Ä–∞–∫—Ä–∞—Å–Ω—ã–π –¥–∞—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è AM312 - [—Å—Å—ã–ª–∫–∞]()
- –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ DHT11/DHT22
- –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä 18650 —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞—Ä—è–¥–∫–∏

## üîå –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```cpp
// –ü–æ—Ä—Ç UART2 –¥–ª—è —Å–≤—è–∑–∏ —Å GSM
Serial2.begin(115200, SERIAL_8N1, 14, 15);

// –ö–ª—é—á–µ–≤—ã–µ –ø–∏–Ω—ã:
#define GSM_RESET_PIN 2    // Reset SIM800L
#define FLASH_LED_PIN 4    // –í—Å–ø—ã—à–∫–∞ –∫–∞–º–µ—Ä—ã
#define VOLT_SENSOR_PIN 12 // –î–∞—Ç—á–∏–∫ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ê–ö–ë
#define DHT_PIN 13         // –î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
#define PIR_PIN 14         // –î–∞—Ç—á–∏–∫ –¥–≤–∏–∂–µ–Ω–∏—è


üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ app                     # –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ app_sim800          # REST API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç SIM800
‚îÇ   ‚îú‚îÄ‚îÄ app_web             # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ blocked_ips.txt     # –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ build-sim800.sh     # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞ API
‚îÇ   ‚îú‚îÄ‚îÄ build-web.sh        # –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ Docker –æ–±—Ä–∞–∑–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ camera_settings.json# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ esp32CamSim800l         # –ü—Ä–æ—à–∏–≤–∫–∞ –¥–ª—è ESP32-CAM
    ‚îú‚îÄ‚îÄ Sim800lClient.cpp   # –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å SIM800L
    ‚îú‚îÄ‚îÄ deviceSettings.cpp  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    ‚îú‚îÄ‚îÄ esp32CamSim800l.ino # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫–µ—Ç—á
    ‚îú‚îÄ‚îÄ apiParams.h         # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã API —Å–µ—Ä–≤–µ—Ä–∞
    ‚îú‚îÄ‚îÄ apnParams.h         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ GPRS –¥–ª—è SIM800
    ‚îî‚îÄ‚îÄ ...
```
    
## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
Docker –∏ Docker Compose
Python 3.8.5 (–¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å TLS)
–®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

#### –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/–≤–∞—à-–∞–∫–∫–∞—É–Ω—Ç/esp32cam-sim800l-monitoring.git
cd esp32cam-sim800l-monitoring
```

#### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ app/camera_settings.json –ø–æ–¥ –≤–∞—à–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ app/app_sim800/config.py –∏ app/app_web/config.py

#### –°–æ–±–µ—Ä–∏—Ç–µ Docker –æ–±—Ä–∞–∑—ã:
```bash
cd app
chmod +x build-sim800.sh build-web.sh
./build-sim800.sh
./build-web.sh
```
#### –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:
```bash
docker compose up -d --force-recreate
```

#### –ü—Ä–æ—à–µ–π—Ç–µ ESP32-CAM:
–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ç–æ—Ä USB CP2102 –∫ ESP32-CAM
–û—Ç–∫—Ä–æ–π—Ç–µ esp32CamSim800l/esp32CamSim800l.ino –≤ Arduino IDE
–ó–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–æ—à–∏–≤–∫—É –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ


## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
#### –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

```bash
python app/app_web/create_admin.py
```

#### –î–æ—Å—Ç—É–ø –∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:
–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É http://–≤–∞—à-—Å–µ—Ä–≤–µ—Ä:–ø–æ—Ä—Ç
–í–æ–π–¥–∏—Ç–µ —Å —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–º–µ—Ä—ã:
–í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–≥–ª–∞—Å–Ω–æ –≤–∞—à–∏–º –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—è–º


## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
–ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π –∏ XSS –∞—Ç–∞–∫
–í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
CORS —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
HTTPS –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
–í–∞–∂–Ω–æ: –ù–µ –∑–∞–±—É–¥—å—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏!

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –ø–∏—Ç–∞–Ω–∏—é
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ DC-DC –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–ª—è ESP32 –∏ SIM800L
- ‚úÖ –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä 1000–º–∫–§ –∫ –ø–∏—Ç–∞–Ω–∏—é GSM –º–æ–¥—É–ª—è
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ: 4.0–í ¬±5% –¥–ª—è SIM800L
- ‚ùå –ò–∑–±–µ–≥–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–Ω–∫–∏—Ö –ø—Ä–æ–≤–æ–¥–æ–≤ –¥–ª—è –ø–∏—Ç–∞–Ω–∏—è GSM –º–æ–¥—É–ª—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ —Ñ–∞–π–ª–µ LICENSE.
